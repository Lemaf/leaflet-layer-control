{"version":3,"sources":["L.llc.js","Layers.js","View.js","Control.js","L.Path.setOpacity.js","L.FeatureGroup.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7SA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1HA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"llc.js","sourcesContent":["L.llc = {\n\n};\n\n\n(function () {\n\n\tvar D2R = Math.PI / 180,\n\t\tR_MAJOR = 6378137,\n\t\tR_MINOR = 6356752;\n\n\tvar R = (R_MAJOR * R_MINOR) / 2;\n\n\t// Refe: https://github.com/Leaflet/Leaflet.draw/blob/master/src/ext/GeometryUtil.js\n\tfunction areaOf(latlngs) {\n\t\tvar area = 0, latlng1, latlng2;\n\n\t\tif (latlngs.length > 2) {\n\n\t\t\tfor (var i = 0; i < latlngs.length; i++) {\n\t\t\t\tlatlng1 = latlngs[i];\n\t\t\t\tlatlng2 = latlngs[(i + 1) % latlngs.length];\n\n\t\t\t\tarea += ((latlng2.lng - latlng1.lng) * D2R) * (2 + Math.sin(latlng1.lat * D2R) + Math.sin(latlng2.lat * D2R));\n\t\t\t}\n\n\t\t\tarea *= R;\n\t\t}\n\n\t\treturn Math.abs(area);\n\t}\n\n\n\tL.llc.areaOf = function (layer) {\n\t\tvar area = 0;\n\n\t\tif (layer instanceof L.FeatureGroup) {\n\n\t\t\tlayer.eachLayer(function (layer) {\n\t\t\t\tarea += L.llc.areaOf(layer);\n\t\t\t});\n\n\t\t} else if (layer instanceof L.Polygon) {\n\n\t\t\tvar latlngs = layer.getLatLngs();\n\n\t\t\tif (Array.isArray(latlngs[0])) {\n\t\t\t\t// shell and holes\n\t\t\t\tarea += areaOf(latlngs[0]);\n\t\t\t\tlatlngs.slice(1).forEach(function (latlngs) {\n\t\t\t\t\tarea -= areaOf(latlngs);\n\t\t\t\t});\n\n\t\t\t} else {\n\n\t\t\t\tarea = areaOf(latlngs);\n\n\t\t\t}\n\t\t}\n\n\t\treturn area;\n\t};\n\n})();","L.llc.Layers = L.Class.extend({\n\n\tincludes: L.Mixin.Events,\n\n\toptions: {\n\n\t},\n\n\tinitialize: function (rootEl, map, options) {\n\t\tL.setOptions(this, options);\n\n\t\tthis._rootEl = rootEl;\n\t\tthis._map = map;\n\n\t\tthis._groups = {};\n\t\tthis._groupsOrder = [];\n\n\t\tthis._layers = {};\n\t\tthis._hidedLayers = [];\n\n\t\tmap\n\t\t\t.on('layeradd', this._onLayerAdd, this)\n\t\t\t.on('layerremove', this._onLayerRemove, this);\n\t},\n\n\taddGroup: function (group) {\n\n\t\tif (this._groups[group.name]) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar parentElement, isSubGroup = false, superGroup;\n\n\t\tif (group.superGroup && (superGroup = this._groups[group.superGroup])) {\n\n\t\t\tif (!superGroup.subRootEl) {\n\t\t\t\tsuperGroup.subRootEl = L.DomUtil.create('div', 'llc-subgroups');\n\n\t\t\t\tif (superGroup.el.nextSibling) {\n\t\t\t\t\tsuperGroup.el.parentNode.insertBefore(superGroup.subRootEl, superGroup.el.nextSibling);\n\t\t\t\t} else {\n\t\t\t\t\tsuperGroup.el.parentNode.appendChild(superGroup.subRootEl);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tparentElement = superGroup.subRootEl;\n\n\t\t\tisSubGroup = true;\n\n\t\t} else {\n\t\t\tparentElement = this._rootEl;\n\t\t}\n\n\t\tvar groupInfo = this._groups[group.name] = {\n\t\t\tname: group.name,\n\t\t\tunique: !!group.unique,\n\t\t\twithOpacity: !group.noOpacity,\n\t\t\tel: L.DomUtil.create('ul', isSubGroup ? 'llc-subgroup' :  'llc-group', parentElement)\n\t\t};\n\n\t\tthis._groupsOrder.push(groupInfo);\n\n\t\tvar li = L.DomUtil.create('li', 'llc-group-title', groupInfo.el);\n\t\tvar spanTitle = L.DomUtil.create('span', '', li);\n\t\tspanTitle.innerHTML = group.name;\n\n\t\treturn this;\n\t},\n\n\taddLayer: function (layer, auto) {\n\n\t\tif (!layer.options) {\n\t\t\treturn this;\n\t\t}\n\n\t\tvar layerID = L.stamp(layer);\n\t\tvar layerInfo = this._layers[layerID];\n\n\t\tif (!layerInfo) {\n\n\t\t\tvar group = this._getGroup(layer.options.group);\n\n\t\t\tif (!group) {\n\t\t\t\treturn this;\n\t\t\t}\n\n\t\t\tlayerInfo = this._layers[layerID] = {\n\t\t\t\tlayer: layer\n\t\t\t};\n\n\t\t\tvar showLayer = this._hidedLayers.indexOf(layerID) === -1;\n\n\t\t\tif (!showLayer) {\n\t\t\t\tthis._maybeHideGroup(group);\n\t\t\t}\n\n\t\t\tvar liEl = L.DomUtil.create('li', 'llc-item', showLayer && group.el);\n\n\t\t\tvar legendEl = L.DomUtil.create('div', 'llc-item-legend', liEl);\n\t\t\tvar visibilityCheckEl = L.DomUtil.create('input', 'llc-item-visibility', liEl);\n\t\t\tvar labelVisibilityEl = L.DomUtil.create('label', 'llc-item-opacity-label', liEl);\n\n\t\t\tvisibilityCheckEl.id = 'llc-' + L.stamp(visibilityCheckEl);\n\t\t\tlabelVisibilityEl.setAttribute('for', visibilityCheckEl.id);\n\n\t\t\t// var span = L.DomUtil.create('span', 'llc-item-title', liEl);\n\t\t\t// span.innerHTML = layer.options.title;\n\n\t\t\tvar truncadeTitle;\n\t\t\tif(layer.options.title.length >= 45) {\n\t\t\t\ttruncadeTitle = layer.options.title\n\t\t\t\t\t.substring(0,42).concat('...');\n\t\t\t} else {\n\t\t\t\ttruncadeTitle = layer.options.title;\n\t\t\t}\n\t\t\t\n\t\t\tlabelVisibilityEl.innerHTML = truncadeTitle;\n\t\t\tlabelVisibilityEl.title = layer.options.title;\n\n\t\t\tliEl._layerID = layerID;\n\t\t\tlayerInfo.group = group;\n\t\t\tlayerInfo.liEl = liEl;\n\t\t\tlayerInfo.legendEl = legendEl;\n\t\t\tlayerInfo.visibilityCheckEl = visibilityCheckEl;\n\n\n\t\t\tvisibilityCheckEl._layerID = layerID;\n\n\t\t\tif (group.unique) {\n\t\t\t\tvisibilityCheckEl.type = 'radio';\n\t\t\t\tvisibilityCheckEl.name = group.name;\n\t\t\t} else {\n\t\t\t\tvisibilityCheckEl.type = 'checkbox';\n\t\t\t}\n\n\t\t\tL.DomEvent\n\t\t\t\t.on(visibilityCheckEl, 'click', this._onVisibilityClick, this);\n\n\t\t\tif (group.withOpacity) {\n\t\t\t\tvar opacityEl = L.DomUtil.create('input', 'llc-item-opacity', liEl);\n\t\t\t\topacityEl.type = 'range';\n\t\t\t\topacityEl.min = 0;\n\t\t\t\topacityEl.max = 100;\n\t\t\t\topacityEl.value = 100;\n\t\t\t\topacityEl._layerID = layerID;\n\t\t\t\tlayerInfo.opacityEl = opacityEl;\n\n\t\t\t\tL.DomEvent\n\t\t\t\t\t.on(opacityEl, 'change', this._onOpacityChange, this);\n\t\t\t}\n\n\t\t\tif (this.options.showAreas) {\n\t\t\t\tif (layer instanceof L.Polygon || layer instanceof L.FeatureGroup) {\n\t\t\t\t\tvar areaEl = L.DomUtil.create('span', 'llc-item-area', liEl);\n\t\t\t\t\tlayerInfo.areaEl = areaEl;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (!auto) {\n\t\t\tthis._layers[layerID].user = true;\n\t\t}\n\n\t\tif (layer.options.legend) {\n\t\t\tL.extend(layerInfo.legendEl.style, layer.options.legend);\n\t\t}\n\n\t\tlayerInfo.inMap = this._map.hasLayer(layer);\n\t\tlayerInfo.visibilityCheckEl.checked = layerInfo.inMap;\n\n\t\treturn this;\n\t},\n\n\taddLegend: function (layer, legend) {\n\t\tvar layerInfo = this._layers[L.stamp(layer)];\n\n\t\tif (!layerInfo) {\n\t\t\tthis.addLayer(layer);\n\t\t\tlayerInfo = this._layers[L.stamp(layer)];\n\t\t}\n\n\t\tif (layerInfo) {\n\t\t\tL.extend(layerInfo.legendEl.style, legend);\n\t\t}\n\t},\n\n\thideLayer: function (layer) {\n\t\tvar layerID = L.stamp(layer);\n\n\t\tif (this._hidedLayers.indexOf(layerID) === -1) {\n\t\t\tthis._hidedLayers.push(layerID);\n\t\t}\n\n\t\tvar layerInfo;\n\t\tif ((layerInfo = this._layers[layerID])) {\n\t\t\tif (layerInfo.liEl.parentNode) {\n\t\t\t\tlayerInfo.liEl.parentNode.removeChild(layerInfo.liEl);\n\n\t\t\t\tthis._maybeHideGroup(layerInfo.group);\n\t\t\t}\n\t\t}\n\n\t\treturn this;\n\t},\n\n\tremoveLayer: function (layer, auto) {\n\t\tvar layerID = L.stamp(layer);\n\t\tvar layerInfo = this._layers[layerID];\n\n\t\tif (layerInfo) {\n\n\t\t\tlayerInfo.inMap = this._map.hasLayer(layer);\n\t\t\tlayerInfo.visibilityCheckEl.checkbox = layerInfo.inMap;\n\n\t\t\tif (!auto) {\n\t\t\t\tlayerInfo.liEl.parentNode.removeChild(layerInfo.liEl);\n\t\t\t\tdelete this._layers[layerID];\n\t\t\t}\n\t\t}\n\t},\n\n\tupdateAreas: function () {\n\t\tvar layerInfo;\n\t\tif (this.options.showAreas) {\n\t\t\tfor (var layerID in this._layers) {\n\t\t\t\tlayerInfo = this._layers[layerID];\n\n\t\t\t\tif (layerInfo.areaEl) {\n\t\t\t\t\tlayerInfo.areaEl.textContent = this.options.formatArea(this.options.areaOf(layerInfo.layer));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\n\t_getGroup: function (groupName) {\n\t\tvar group = this._groups[groupName];\n\n\t\tif (!group) {\n\t\t\tgroup = this._groups[this.options.defaultGroup];\n\t\t}\n\n\t\treturn group;\n\t},\n\n\t_maybeHideGroup: function (group) {\n\t\tif (!group.showAlways && group.el.childNodes.length === 1) {\n\t\t\tgroup.el.parentNode.removeChild(group.el);\n\t\t}\n\t},\n\n\t_onLayerAdd: function (evt) {\n\t\tthis.addLayer(evt.layer, true);\n\t},\n\n\t_onLayerRemove: function (evt) {\n\t\tthis.removeLayer(evt.layer, true);\n\t},\n\n\t_onOpacityChange: function (event) {\n\t\tvar opacity = parseInt(event.currentTarget.value) / 100;\n\t\tvar layerInfo = this._layers[event.currentTarget._layerID];\n\n\t\tif (layerInfo) {\n\t\t\tlayerInfo.layer.setStyle({opacity: opacity, fillOpacity: opacity});\n\t\t}\n\t},\n\n\t_onVisibilityClick: function (event) {\n\n\t\tvar layerInfo = this._layers[event.currentTarget._layerID];\n\t\tif (layerInfo) {\n\n\t\t\tvar group = layerInfo.group, otherLayerInfo;\n\n\t\t\tif (group.unique) {\n\n\t\t\t\tif (layerInfo.inMap) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tfor (var layerID in this._layers) {\n\t\t\t\t\totherLayerInfo = this._layers[layerID];\n\n\t\t\t\t\tif (otherLayerInfo !== layerInfo && otherLayerInfo.group === group) {\n\t\t\t\t\t\tif (otherLayerInfo.inMap) {\n\t\t\t\t\t\t\tthis._map.removeLayer(otherLayerInfo.layer);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis._map.addLayer(layerInfo.layer);\n\n\t\t\t} else {\n\t\t\t\tif (layerInfo.inMap) {\n\t\t\t\t\tthis._map.removeLayer(layerInfo.layer);\n\t\t\t\t} else {\n\t\t\t\t\tthis._map.addLayer(layerInfo.layer);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n});","/**\n * @requires Layers.js\n */\nL.llc.View = L.Class.extend({\n\n\tincludes: L.Mixin.Events,\n\n\toptions: {\n\n\t},\n\n\tinitialize: function (map, options) {\n\t\tthis._map = map;\n\t\tL.setOptions(this, options.layers);\n\n\t\tvar containerEl = this._containerEl = L.DomUtil.create('div', 'llc-container');\n\n\t\tL.extend(containerEl.style, {\n\t\t\toverflow: 'hidden'\n\t\t});\n\n\t\tvar canvasEl = this._canvasEl = L.DomUtil.create('div', 'llc-canvas', containerEl);\n\n\t\tvar headerEl = this._headerEl = L.DomUtil.create('div', 'llc-header', canvasEl);\n\n\t\tvar titleEl = this._titleEl = L.DomUtil.create('div', 'llc-title', headerEl);\n\n\t\tvar spanTitle = L.DomUtil.create('span', '', titleEl);\n\t\tspanTitle.innerHTML = options.llcTitle ? options.llcTitle:'';\n\n\t\tthis._groupsRootEl = L.DomUtil.create('div', 'llc-groups', canvasEl);\n\t\tvar footerEl = this._footerEl = L.DomUtil.create('div', 'llc-footer', canvasEl);\n\t\tvar closeEl;\n\n\t\tif (options.position.indexOf('bottomright') === 0) {\n\t\t\tcloseEl = this._closeEl = L.DomUtil.create('div', 'llc-close-right', footerEl);\n\t\t} else if (options.position.indexOf('topright') === 0) {\n\t\t\tcloseEl = this._closeEl = L.DomUtil.create('div', 'llc-close-right', headerEl);\n\t\t} else if (options.position.indexOf('bottomleft') === 0) {\n\t\t\tcloseEl = this._closeEl = L.DomUtil.create('div', 'llc-close-left', footerEl);\n\t\t} else if (options.position.indexOf('topleft') === 0) {\n\t\t\tcloseEl = this._closeEl = L.DomUtil.create('div', 'llc-close-left', headerEl);\n\t\t}\t\t\t\n\n\t\tthis._fragments = {\n\t\t\tlayers: new L.llc.Layers(this._groupsRootEl, map, {\n\t\t\t\tshowAreas: this.options.showAreas,\n\t\t\t\tformatArea: this.options.formatArea,\n\t\t\t\tareaOf: this.options.areaOf\n\t\t\t})\n\t\t};\n\n\t\tif (this.options.groups) {\n\t\t\tthis.options.groups.forEach(this._addGroup, this);\n\t\t}\n\n\t\tL.DomEvent\n\t\t\t.on(containerEl, 'click', L.DomEvent.stopPropagation)\n\t\t\t.on(containerEl, 'dblclick', L.DomEvent.stopPropagation)\n\t\t\t.on(containerEl, 'mousedown', L.DomEvent.stopPropagation)\n\t\t\t.on(containerEl, 'wheel', L.DomEvent.stopPropagation)\n\t\t\t.on(closeEl, 'click', this._onCloseClick, this);\n\t},\n\n\taddLayer: function (layer, auto) {\n\t\tthis._fragments.layers.addLayer(layer, auto);\n\t\treturn this;\n\t},\n\n\taddLegend: function (layer, legend) {\n\t\tthis._fragments.layers.addLegend(layer, legend);\n\t\treturn this;\n\t},\n\n\tclose: function () {\n\t\tif (this._visible) {\n\t\t\tthis._close();\n\t\t}\n\t},\n\n\thideLayer: function (layer) {\n\t\tthis._fragments.layers.hideLayer(layer);\n\t\treturn this;\n\t},\n\n\tshow: function (fromEl, position) {\n\t\tif (!this._visible) {\n\t\t\tthis._visible = true;\n\n\t\t\tthis._show(fromEl, position);\n\t\t}\n\t},\n\n\tupdateAreas: function () {\n\t\tthis._fragments.layers.updateAreas();\n\t},\n\n\t_addGroup: function (group) {\n\t\tthis._fragments.layers.addGroup(group);\n\t},\n\n\t_close: function () {\n\n\t\tvar containerEl = this._containerEl,\n\t\t    fromEl = this._fromEl,\n\t\t    canvasEl = this._canvasEl;\n\n\t\tL.extend(this._fromEl.style, {\n\t\t\topacity: 0,\n\t\t\tdisplay: 'block'\n\t\t});\n\n\t\tvar player = canvasEl.animate([\n\t\t\t{opacity: 1}, {opacity: 0}\n\t\t], this.options.animationTime / 2);\n\n\t\tL.DomEvent.on(player, 'finish', function () {\n\t\t\tcanvasEl.style.display = 'none';\n\t\t});\n\n\t\tplayer = containerEl.animate([\n\t\t\t{\n\t\t\t\theight: containerEl.offsetHeight + 'px',\n\t\t\t\twidth: containerEl.offsetWidth + 'px',\n\t\t\t\topacity: 1\n\t\t\t}, {\n\t\t\t\theight: fromEl.offsetHeight + 'px',\n\t\t\t\twidth: fromEl.offsetWidth + 'px',\n\t\t\t\topacity: 0,\n\t\t\t\teasing: 'ease-in-out'\n\t\t\t}\n\t\t], this.options.animationTime);\n\n\t\tL.DomEvent.on(player, 'finish', function () {\n\t\t\tcontainerEl.parentNode.removeChild(containerEl);\n\t\t});\n\n\t\tplayer = fromEl.animate([\n\t\t\t{\n\t\t\t\topacity: 0\n\t\t\t},\n\t\t\t{\n\t\t\t\topacity: 1\n\t\t\t}\n\t\t], this.options.animationTime);\n\n\t\tL.DomEvent.on(player, 'finish', function () {\n\t\t\t\tdelete this._visible;\n\t\t\t\tL.extend(fromEl.style, {\n\t\t\t\t\tdisplay: 'block',\n\t\t\t\t\topacity: ''\n\t\t\t\t});\n\t\t\t}, this);\n\t},\n\n\t_onCloseClick: function () {\n\t\tthis.close();\n\t},\n\n\t_onLayerAdd: function (evt) {\n\t\tthis.addLayer(evt.layer, true);\n\t},\n\n\t_onLayerRemove: function (evt) {\n\t\tthis.removeLayer(evt.layer);\n\t},\n\n\t_show: function (fromEl, position) {\n\n\t\tL.extend(this._canvasEl.style, {\n\t\t\tdisplay: 'block',\n\t\t\topacity: 0\n\t\t});\n\n\t\tvar cssPosition = {};\n\n\t\tif (position.indexOf('bottom') === 0) {\n\t\t\tcssPosition.bottom = (fromEl.offsetParent.offsetHeight - (fromEl.offsetTop + fromEl.offsetHeight)) + 'px';\n\t\t} else {\n\t\t\tcssPosition.top = fromEl.offsetTop + 'px';\n\t\t}\n\n\t\tif (position.indexOf('right') >= 0) {\n\t\t\tcssPosition.right = (fromEl.offsetParent.offsetWidth - (fromEl.offsetLeft + fromEl.offsetWidth)) + 'px';\n\t\t} else {\n\t\t\tcssPosition.left = fromEl.offsetLeft + 'px';\n\t\t}\n\n\t\tthis._cssPosition = cssPosition;\n\n\t\tL.extend(this._containerEl.style, {\n\t\t\theight: fromEl.offsetHeight + 'px',\n\t\t\tposition: 'absolute',\n\t\t\twidth: fromEl.offsetWidth + 'px'\n\t\t}, this._cssPosition);\n\n\t\tfromEl.parentNode.appendChild(this._containerEl);\n\t\tthis._fromEl = fromEl;\n\n\t\tvar player = this._containerEl.animate([\n\t\t\t{\n\t\t\t\theight: fromEl.offsetHeight + 'px',\n\t\t\t\twidth: fromEl.offsetWidth + 'px',\n\t\t\t\topacity: 0\n\t\t\t}, {\n\t\t\t\theight: this._containerEl.scrollHeight + 'px',\n\t\t\t\twidth: this._containerEl.scrollWidth + 'px',\n\t\t\t\topacity: 1,\n\t\t\t\teasing: 'ease-in-out'\n\t\t\t}\n\t\t], this.options.animationTime / 2);\n\n\t\tL.DomEvent\n\t\t\t.on(player, 'finish', function () {\n\t\t\t\tL.extend(this._containerEl.style, {\n\t\t\t\t\theight: this._containerEl.scrollHeight + 'px',\n\t\t\t\t\twidth: this._containerEl.scrollWidth + 'px'\n\t\t\t\t});\n\t\t\t}, this);\n\n\t\tplayer = this._canvasEl.animate([\n\t\t\t{opacity: 0},\n\t\t\t{opacity: 1}\n\t\t], this.options.animationTime);\n\n\t\tL.DomEvent\n\t\t\t.on(player, 'finish', function () {\n\t\t\t\tL.extend(this._canvasEl.style, {\n\t\t\t\t\topacity: 1\n\t\t\t\t});\n\t\t\t}, this);\n\n\n\t\tplayer = fromEl.animate([\n\t\t\t{opacity: 1}, {opacity: 0}\n\t\t], this.options.animationTime);\n\n\t\tL.DomEvent.on(player, 'finish', function () {\n\t\t\tfromEl.style.display = 'none';\n\t\t});\n\t}\n});\n\nL.llc.view = function (map, options) {\n\treturn new L.llc.View(map, options);\n};\n","/**\n * @requires View.js\n */\nL.llc.Control = L.Control.extend({\n\n\tincludes: L.Mixin.Events,\n\n\toptions: {\n\t\tposition: 'bottomright',\n\t\tlayers: {\n\n\t\t\tanimationTime: 500,\n\n\t\t\tshowAreas: true,\n\n\t\t\tformatArea: function (area) {\n\t\t\t\tif (area >= 1e3) {\n\t\t\t\t\treturn L.Util.formatNum(area / 1e4, 4) + 'ha';\n\t\t\t\t} else {\n\t\t\t\t\treturn L.Util.formatNum(area, 4) + 'm²';\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tareaOf: L.llc.areaOf,\n\n\t\t\tgroups: [],\n\n\t\t\tdefaultGroup: null\n\t\t},\n\t\tparentElement: null\n\t},\n\n\tinitialize: function (options) {\n\t\tvar layerOptions = L.extend({}, this.options.layers, options && options.layers);\n\n\t\toptions = L.extend({}, this.options, options || {}, {\n\t\t\tlayers: layerOptions\n\t\t});\n\n\t\tL.Control.prototype.initialize.call(this, options);\n\t},\n\n\taddLayer: function (layer) {\n\t\tthis._toInvoke('addLayer', layer);\n\t\treturn this;\n\t},\n\n\taddLegend: function (layer, legend) {\n\t\tthis._toInvoke('addLegend', layer, legend);\n\t\treturn this;\n\t},\n\n\thideLayer: function (layer) {\n\t\tthis._toInvoke('hideLayer', layer);\n\t\treturn this;\n\t},\n\n\tshowLayer: function (layer) {\n\t\tthis._toInvoke('showLayer', layer);\n\t\treturn this;\n\t},\n\n\tonAdd: function (map) {\n\t\tthis._viewLayers = L.llc.view(map, this.options);\n\n\t\tvar button = L.DomUtil.create('div', 'llc llc-button');\n\n\t\tL.DomEvent\n\t\t\t.on(button, 'click', this._onButtonClick, this)\n\t\t\t.on(button, 'click', L.DomEvent.stop)\n\t\t\t.on(button, 'dblclick', L.DomEvent.stop)\n\t\t\t.on(button, 'mousedown', L.DomEvent.stop);\n\n\t\tthis._invokeInvokes();\n\n\t\tthis._map.eachLayer(function (layer) {\n\t\t\tthis._viewLayers.addLayer(layer, true);\n\t\t}, this);\n\n\t\treturn button;\n\t},\n\n\tupdateAreas: function () {\n\t\tthis._toInvoke('updateAreas');\n\t\treturn this;\n\t},\n\n\t_invokeInvoke: function (invoke) {\n\t\tif (this._viewLayers) {\n\t\t\tthis._viewLayers[invoke.method].apply(this._viewLayers, invoke.args);\n\t\t}\n\t},\n\n\t_invokeInvokes: function() {\n\t\tif (this._invokes) {\n\t\t\tfor (var i=0; i < this._invokes.length; i++) {\n\t\t\t\tthis._invokeInvoke(this._invokes[i]);\n\t\t\t}\n\t\t}\n\t},\n\n\t_onButtonClick: function () {\n\t\tthis._viewLayers.show(this._container, this.getPosition());\n\t},\n\n\t_toInvoke: function (method) {\n\t\tvar args = Array.prototype.slice.call(arguments, 1);\n\n\t\tif (!this._invokes) {\n\t\t\tthis._invokes = [];\n\t\t}\n\n\t\tvar invoke = {method: method, args: args};\n\t\tthis._invokes.push(invoke);\n\n\t\tthis._invokeInvoke(invoke);\n\t}\n\n});\n\nL.Control.lc = function (options) {\n\treturn new L.llc.Control(options);\n};","if (!L.Path.prototype.setOpacity) {\n\n\t(function () {\n\n\t\tif (L.Path.SVG || L.Path.VML) {\n\n\t\t\tL.Path.include({\n\n\t\t\t\tsetOpacity: function (opacity) {\n\t\t\t\t\tthis._opacity = opacity;\n\t\t\t\t\tif (this._container) {\n\t\t\t\t\t\tthis._container.style.opacity = opacity;\n\t\t\t\t\t}\n\n\t\t\t\t}, _updateOpacity: function () {\n\t\t\t\t\tif (this._opacity !== undefined) {\n\t\t\t\t\t\tthis.setOpacity(this._opacity);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tL.Path.addInitHook(function () {\n\t\t\t\tthis.on('add', this._updateOpacity);\n\t\t\t});\n\n\t\t} else if (L.Path.CANVAS) {\n\n\t\t\t// TODO: Arrrghhh!\n\n\t\t\tL.Path.include({\n\n\t\t\t\tsetOpacity: function (opacity) {\n\t\t\t\t\tthis._opacity = opacity;\n\t\t\t\t\tthis.redraw();\n\t\t\t\t},\n\n\t\t\t\t_updatePath: function () {\n\n\t\t\t\t\tif (this._checkIfEmpty()) { \n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar ctx = this._ctx,\n\t\t\t\t\t    options = this.options,\n\t\t\t\t\t    opacity = this._opacity !== undefined ? this._opacity : 1;\n\n\t\t\t\t\tthis._drawPath();\n\t\t\t\t\tctx.save();\n\t\t\t\t\tthis._updateStyle();\n\n\n\t\t\t\t\tif (options.fill) {\n\t\t\t\t\t\tctx.globalAlpha = options.fillOpacity * opacity;\n\t\t\t\t\t\tctx.fill(options.fillRule || 'evenodd');\n\t\t\t\t\t}\n\n\t\t\t\t\tif (options.stroke) {\n\t\t\t\t\t\tctx.globalAlpha = options.opacity * opacity;\n\t\t\t\t\t\tctx.stroke();\n\t\t\t\t\t}\n\t\t\t\t\tctx.restore();\n\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\n\t})();\n\n}","if (!L.FeatureGroup.prototype.setOpacity) {\n\n\tL.FeatureGroup.include({\n\n\t\tsetOpacity: function(opacity) {\n\n\t\t\tthis.eachLayer(function(layer) {\n\n\t\t\t\tif(layer.setOpacity) {\n\t\t\t\t\tlayer.setOpacity(opacity);\n\t\t\t\t}\n\n\t\t\t});\n\n\t\t}\n\n\t});\n\n}"]}