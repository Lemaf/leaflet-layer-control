L.llc={},function(){function t(t){var i,n,s=0;if(t.length>2){for(var a=0;a<t.length;a++)i=t[a],n=t[(a+1)%t.length],s+=(n.lng-i.lng)*e*(2+Math.sin(i.lat*e)+Math.sin(n.lat*e));s*=o}return s}var e=L.LatLng.DEG_TO_RAD,i=6378137,n=6356752,o=i*n/2;L.llc.areaOf=function(e){var i=0;if(e instanceof L.FeatureGroup)e.eachLayer(function(t){i+=L.llc.Control.areaOf(t)});else if(e instanceof L.Polygon){var n=e.getLatLngs();Array.isArray(n[0])?(i+=t(n[0]),n.slice(0).forEach(function(e){i-=t(e)})):i=t(n)}return i}}(),L.llc.Layers=L.Class.extend({includes:L.Mixin.Events,options:{},initialize:function(t,e,i){L.setOptions(this,i),this._rootEl=t,this._map=e,this._groups={},this._groupsOrder=[],this._layers={},this._hidedLayers=[],e.on("layeradd",this._onLayerAdd,this).on("layerremove",this._onLayerRemove,this)},addGroup:function(t){if(!this._groups[t.name]){var e=this._groups[t.name]={name:t.name,unique:!!t.unique,el:L.DomUtil.create("ul","llc-group",this._rootEl)};this._groupsOrder.push(e);var i=L.DomUtil.create("li","llc-group-title",e.el),n=L.DomUtil.create("span",null,i);return n.innerHTML=t.name,this}},addLayer:function(t,e){if(!t.options)return this;var i=L.stamp(t),n=this._layers[i];if(!n){n=this._layers[i]={layer:t};var o=-1===this._hidedLayers.indexOf(i),s=this._getGroup(t.options.group);o||this._maybeHideGroup(s);var a=L.DomUtil.create("li","llc-item",o&&s.el),r=L.DomUtil.create("div","llc-item-legend",a),l=L.DomUtil.create("input","llc-item-visibility",a),h=L.DomUtil.create("label","llc-item-opacity-label",a);if(l.id="llc-"+L.stamp(l),h.setAttribute("for",l.id),h.innerHTML=t.options.title,a._layerID=i,n.group=s,n.liEl=a,n.legendEl=r,n.visibilityCheckEl=l,l._layerID=i,s.unique?(l.type="radio",l.name=s.name):l.type="checkbox",L.DomEvent.on(l,"click",this._onVisibilityClick,this),t.setOpacity){var c=L.DomUtil.create("input","llc-item-opacity",a);c.type="range",c.min=0,c.max=100,c._layerID=i,n.opacityEl=c,L.DomEvent.on(c,"change",this._onOpacityChange,this)}if(this.options.showAreas&&(t instanceof L.Polygon||t instanceof L.FeatureGroup)){var d=L.DomUtil.create("span","llc-item-area",a);n.areaEl=d}}return e||(this._layers[i].user=!0),t.options.legend&&L.extend(n.legendEl.style,t.options.legend),this._layers[i].inMap=this._map.hasLayer(t),this._layers[i].inMap&&(this._layers[i].visibilityCheckEl.checked=!0),this},addLegend:function(t,e){var i=this._layers[L.stamp(t)];i||(this.addLayer(t),i=this._layers[L.stamp(t)]),i&&L.extend(i.legendEl.style,e)},hideLayer:function(t){var e=L.stamp(t);-1===this._hidedLayers.indexOf(e)&&this._hidedLayers.push(e);var i;return(i=this._layers[e])&&i.liEl.parentNode&&(i.liEl.parentNode.removeChild(i.liEl),this._maybeHideGroup(i.group)),this},removeLayer:function(t,e){var i=L.stamp(t),n=this._layers[i];n&&(delete n.inMap,n.visibilityCheckEl.checkbox=!!n.inMap,e||(n.liEl.parentNode.removeChild(n.liEl),delete this._layers[i]))},updateAreas:function(){var t;if(this.options.showAreas)for(var e in this._layers)t=this._layers[e],t.areaEl&&(t.areaEl.textContent=this.options.formatArea(L.llc.areaOf(t.layer)))},_maybeHideGroup:function(t){t.showAlways||1!==t.el.childNodes.length||t.el.parentNode.removeChild(t.el)},_getGroup:function(t){var e=this._groups[t];return e||(this._addGroup({name:"default"}),e=this._groups["default"]),e},_onLayerAdd:function(t){this.addLayer(t.layer,!0)},_onLayerRemove:function(t){this.removeLayer(t.layer,!0)},_onOpacityChange:function(t){var e=parseInt(t.currentTarget.value)/100,i=this._layers[t.currentTarget._layerID];i&&i.layer.setOpacity(e)},_onVisibilityClick:function(t){var e=this._layers[t.currentTarget._layerID];if(e){var i,n=e.group;if(n.unique){if(e.inMap)return;for(var o in this._layers)i=this._layers[o],i!==e&&i.group===n&&i.inMap&&this._map.removeLayer(i.layer);this._map.addLayer(e.layer)}else e.inMap?this._map.removeLayer(e.layer):this._map.addLayer(e.layer)}}}),L.llc.View=L.Class.extend({includes:L.Mixin.Events,options:{},initialize:function(t,e){this._map=t,L.setOptions(this,e);var i=this._containerEl=L.DomUtil.create("div","llc-container");L.extend(i.style,{overflow:"hidden"});var n=this._canvasEl=L.DomUtil.create("div","llc-canvas",i),o=this._headerEl=L.DomUtil.create("div","llc-header",n),s=this._closeEl=L.DomUtil.create("div","llc-close",o);this._groupsRootEl=L.DomUtil.create("div","llc-groups",n),this._fragments={layers:new L.llc.Layers(this._groupsRootEl,t,{showAreas:this.options.showAreas,formatArea:this.options.formatArea})},this.options.groups&&this.options.groups.forEach(this._addGroup,this),L.DomEvent.on(i,"click",L.DomEvent.stopPropagation).on(i,"dblclick",L.DomEvent.stopPropagation).on(i,"mousedown",L.DomEvent.stopPropagation).on(i,"wheel",L.DomEvent.stopPropagation).on(s,"click",this._onCloseClick,this)},addLayer:function(t,e){return this._fragments.layers.addLayer(t,e),this},addLegend:function(t,e){return this._fragments.layers.addLegend(t,e),this},close:function(){this._visible&&this._close()},hideLayer:function(t){return this._fragments.layers.hideLayer(t),this},show:function(t,e){this._visible||(this._visible=!0,this._show(t,e))},updateAreas:function(){this._fragments.layers.updateAreas()},_addGroup:function(t){this._fragments.layers.addGroup(t)},_close:function(){delete this._visible,this._containerEl.parentNode.removeChild(this._containerEl),this._fromEl.style.display="block"},_onCloseClick:function(){this.close()},_onLayerAdd:function(t){this.addLayer(t.layer,!0)},_onLayerRemove:function(t){this.removeLayer(t.layer)},_onItemClick:function(){},_show:function(t,e){L.extend(this._canvasEl.style,{opacity:0});var i={};0===e.indexOf("bottom")?i.bottom=t.offsetParent.offsetHeight-(t.offsetTop+t.offsetHeight)+"px":i.top=t.offsetTop+"px",e.indexOf("right")>=0?i.right=t.offsetParent.offsetWidth-(t.offsetLeft+t.offsetWidth)+"px":i.left=t.offsetLeft+"px",this._cssPosition=i,L.extend(this._containerEl.style,{height:t.offsetHeight+"px",position:"absolute",width:t.offsetWidth+"px"},this._cssPosition),t.parentNode.appendChild(this._containerEl),t.style.display="none",this._fromEl=t,this._containerEl.style.background="#ffffff";var n=this._containerEl.animate([{height:t.offsetHeight+"px",width:t.offsetWidth+"px"},{height:this._containerEl.scrollHeight+"px",width:this._containerEl.scrollWidth+"px",easing:"ease-in-out"}],500);L.DomEvent.on(n,"finish",function(){L.extend(this._containerEl.style,{height:this._containerEl.scrollHeight+"px",width:this._containerEl.scrollWidth+"px"})},this),n=this._canvasEl.animate([{opacity:0},{opacity:1}],500),L.DomEvent.on(n,"finish",function(){L.extend(this._canvasEl.style,{opacity:1})},this)}}),L.llc.view=function(t,e){return new L.llc.View(t,e)},L.llc.Control=L.Control.extend({includes:L.Mixin.Events,options:{position:"bottomright",layers:{showAreas:!0,formatArea:function(t){return t>=1e3?L.Util.formatNum(t/1e4,4)+"ha":L.Util.formatNum(t,4)+"m"},groups:[]},parentElement:null},initialize:function(t){var e=L.extend({},this.options.layers,t&&t.layers);t=L.extend({},this.options,t||{},{layers:e}),L.Control.prototype.initialize.call(this,t)},addLayer:function(t){return this._toInvoke("addLayer",t),this},addLegend:function(t,e){return this._toInvoke("addLegend",t,e),this},hideLayer:function(t){return this._toInvoke("hideLayer",t),this},showLayer:function(t){return this._toInvoke("showLayer",t),this},onAdd:function(t){this._viewLayers=L.llc.view(t,this.options.layers);var e=L.DomUtil.create("div","llc llc-button");return L.DomEvent.on(e,"click",this._onButtonClick,this).on(e,"click",L.DomEvent.stop).on(e,"dblclick",L.DomEvent.stop).on(e,"mousedown",L.DomEvent.stop),this._invokeInvokes(),this._map.eachLayer(function(t){this._viewLayers.addLayer(t,!0)},this),e},updateAreas:function(){return this._toInvoke("updateAreas"),this},_invokeInvoke:function(t){this._viewLayers&&this._viewLayers[t.method].apply(this._viewLayers,t.args)},_invokeInvokes:function(){if(this._invokes)for(var t=0;t<this._invokes.length;t++)this._invokeInvoke(this._invokes[t])},_onButtonClick:function(){this._viewLayers.show(this._container,this.getPosition())},_toInvoke:function(t){var e=Array.prototype.slice.call(arguments,1);this._invokes||(this._invokes=[]);var i={method:t,args:e};this._invokes.push(i),this._invokeInvoke(i)}}),L.Control.lc=function(t){return new L.llc.Control(t)};