L.llc={},function(){function t(t){var e,o,s=0;if(t.length>2){for(var a=0;a<t.length;a++)e=t[a],o=t[(a+1)%t.length],s+=(o.lng-e.lng)*i*(2+Math.sin(e.lat*i)+Math.sin(o.lat*i));s*=n}return Math.abs(s)}var i=L.LatLng.DEG_TO_RAD,e=6378137,o=6356752,n=e*o/2;L.llc.areaOf=function(i){var e=0;if(i instanceof L.FeatureGroup)i.eachLayer(function(t){e+=L.llc.areaOf(t)});else if(i instanceof L.Polygon){var o=i.getLatLngs();Array.isArray(o[0])?(e+=t(o[0]),o.slice(0).forEach(function(i){e-=t(i)})):e=t(o)}return e}}(),L.llc.Layers=L.Class.extend({includes:L.Mixin.Events,options:{},initialize:function(t,i,e){L.setOptions(this,e),this._rootEl=t,this._map=i,this._groups={},this._groupsOrder=[],this._layers={},this._hidedLayers=[],i.on("layeradd",this._onLayerAdd,this).on("layerremove",this._onLayerRemove,this)},addGroup:function(t){if(!this._groups[t.name]){var i,e,o=!1;t.superGroup&&(e=this._groups[t.superGroup])?(e.subRootEl||(e.subRootEl=L.DomUtil.create("div","llc-subgroups"),e.el.nextSibling?e.el.parentNode.insertBefore(e.subRootEl,e.el.nextSibling):e.el.parentNode.appendChild(e.subRootEl)),i=e.subRootEl,o=!0):i=this._rootEl;var n=this._groups[t.name]={name:t.name,unique:!!t.unique,withOpacity:!t.noOpacity,el:L.DomUtil.create("ul",o?"llc-subgroup":"llc-group",i)};this._groupsOrder.push(n);var s=L.DomUtil.create("li","llc-group-title",n.el),a=L.DomUtil.create("span","",s);return a.innerHTML=t.name,this}},addLayer:function(t,i){if(!t.options)return this;var e=L.stamp(t),o=this._layers[e];if(!o){var n=this._getGroup(t.options.group);if(!n)return this;o=this._layers[e]={layer:t};var s=-1===this._hidedLayers.indexOf(e);s||this._maybeHideGroup(n);var a=L.DomUtil.create("li","llc-item",s&&n.el),r=L.DomUtil.create("div","llc-item-legend",a),l=L.DomUtil.create("input","llc-item-visibility",a),h=L.DomUtil.create("label","llc-item-opacity-label",a);if(l.id="llc-"+L.stamp(l),h.setAttribute("for",l.id),h.innerHTML=t.options.title,a._layerID=e,o.group=n,o.liEl=a,o.legendEl=r,o.visibilityCheckEl=l,l._layerID=e,n.unique?(l.type="radio",l.name=n.name):l.type="checkbox",L.DomEvent.on(l,"click",this._onVisibilityClick,this),n.withOpacity&&t.setOpacity){var c=L.DomUtil.create("input","llc-item-opacity",a);c.type="range",c.min=0,c.max=100,c.value=100,c._layerID=e,o.opacityEl=c,L.DomEvent.on(c,"change",this._onOpacityChange,this)}if(this.options.showAreas&&(t instanceof L.Polygon||t instanceof L.FeatureGroup)){var p=L.DomUtil.create("span","llc-item-area",a);o.areaEl=p}}return i||(this._layers[e].user=!0),t.options.legend&&L.extend(o.legendEl.style,t.options.legend),o.inMap=this._map.hasLayer(t),o.visibilityCheckEl.checked=o.inMap,this},addLegend:function(t,i){var e=this._layers[L.stamp(t)];e||(this.addLayer(t),e=this._layers[L.stamp(t)]),e&&L.extend(e.legendEl.style,i)},hideLayer:function(t){var i=L.stamp(t);-1===this._hidedLayers.indexOf(i)&&this._hidedLayers.push(i);var e;return(e=this._layers[i])&&e.liEl.parentNode&&(e.liEl.parentNode.removeChild(e.liEl),this._maybeHideGroup(e.group)),this},removeLayer:function(t,i){var e=L.stamp(t),o=this._layers[e];o&&(o.inMap=this._map.hasLayer(t),o.visibilityCheckEl.checkbox=o.inMap,i||(o.liEl.parentNode.removeChild(o.liEl),delete this._layers[e]))},updateAreas:function(){var t;if(this.options.showAreas)for(var i in this._layers)t=this._layers[i],t.areaEl&&(t.areaEl.textContent=this.options.formatArea(L.llc.areaOf(t.layer)))},_getGroup:function(t){var i=this._groups[t];return i||(i=this._groups[this.options.defaultGroup]),i},_maybeHideGroup:function(t){t.showAlways||1!==t.el.childNodes.length||t.el.parentNode.removeChild(t.el)},_onLayerAdd:function(t){this.addLayer(t.layer,!0)},_onLayerRemove:function(t){this.removeLayer(t.layer,!0)},_onOpacityChange:function(t){var i=parseInt(t.currentTarget.value)/100,e=this._layers[t.currentTarget._layerID];e&&e.layer.setOpacity(i)},_onVisibilityClick:function(t){var i=this._layers[t.currentTarget._layerID];if(i){var e,o=i.group;if(o.unique){if(i.inMap)return;for(var n in this._layers)e=this._layers[n],e!==i&&e.group===o&&e.inMap&&this._map.removeLayer(e.layer);this._map.addLayer(i.layer)}else i.inMap?this._map.removeLayer(i.layer):this._map.addLayer(i.layer)}}}),L.llc.View=L.Class.extend({includes:L.Mixin.Events,options:{},initialize:function(t,i){this._map=t,L.setOptions(this,i.layers);var e=this._containerEl=L.DomUtil.create("div","llc-container");L.extend(e.style,{overflow:"hidden"});var o=this._canvasEl=L.DomUtil.create("div","llc-canvas",e),n=this._headerEl=L.DomUtil.create("div","llc-header",o),s=this._titleEl=L.DomUtil.create("div","llc-title",n),a=L.DomUtil.create("span","",s);a.innerHTML=i.llcTitle?i.llcTitle:"",this._groupsRootEl=L.DomUtil.create("div","llc-groups",o);var r,l=this._footerEl=L.DomUtil.create("div","llc-footer",o);0===i.position.indexOf("bottomright")?r=this._closeEl=L.DomUtil.create("div","llc-close-right",l):0===i.position.indexOf("topright")?r=this._closeEl=L.DomUtil.create("div","llc-close-right",n):0===i.position.indexOf("bottomleft")?r=this._closeEl=L.DomUtil.create("div","llc-close-left",l):0===i.position.indexOf("topleft")&&(r=this._closeEl=L.DomUtil.create("div","llc-close-left",n)),this._fragments={layers:new L.llc.Layers(this._groupsRootEl,t,{showAreas:this.options.showAreas,formatArea:this.options.formatArea})},this.options.groups&&this.options.groups.forEach(this._addGroup,this),L.DomEvent.on(e,"click",L.DomEvent.stopPropagation).on(e,"dblclick",L.DomEvent.stopPropagation).on(e,"mousedown",L.DomEvent.stopPropagation).on(e,"wheel",L.DomEvent.stopPropagation).on(r,"click",this._onCloseClick,this)},addLayer:function(t,i){return this._fragments.layers.addLayer(t,i),this},addLegend:function(t,i){return this._fragments.layers.addLegend(t,i),this},close:function(){this._visible&&this._close()},hideLayer:function(t){return this._fragments.layers.hideLayer(t),this},show:function(t,i){this._visible||(this._visible=!0,this._show(t,i))},updateAreas:function(){this._fragments.layers.updateAreas()},_addGroup:function(t){this._fragments.layers.addGroup(t)},_close:function(){var t=this._containerEl,i=this._fromEl,e=this._canvasEl;L.extend(this._fromEl.style,{opacity:0,display:"block"});var o=e.animate([{opacity:1},{opacity:0}],this.options.animationTime/2);L.DomEvent.on(o,"finish",function(){e.style.display="none"}),o=t.animate([{height:t.offsetHeight+"px",width:t.offsetWidth+"px",opacity:1},{height:i.offsetHeight+"px",width:i.offsetWidth+"px",opacity:0,easing:"ease-in-out"}],this.options.animationTime),L.DomEvent.on(o,"finish",function(){t.parentNode.removeChild(t)}),o=i.animate([{opacity:0},{opacity:1}],this.options.animationTime),L.DomEvent.on(o,"finish",function(){delete this._visible,L.extend(i.style,{display:"block",opacity:""})},this)},_onCloseClick:function(){this.close()},_onLayerAdd:function(t){this.addLayer(t.layer,!0)},_onLayerRemove:function(t){this.removeLayer(t.layer)},_show:function(t,i){L.extend(this._canvasEl.style,{display:"block",opacity:0});var e={};0===i.indexOf("bottom")?e.bottom=t.offsetParent.offsetHeight-(t.offsetTop+t.offsetHeight)+"px":e.top=t.offsetTop+"px",i.indexOf("right")>=0?e.right=t.offsetParent.offsetWidth-(t.offsetLeft+t.offsetWidth)+"px":e.left=t.offsetLeft+"px",this._cssPosition=e,L.extend(this._containerEl.style,{height:t.offsetHeight+"px",position:"absolute",width:t.offsetWidth+"px"},this._cssPosition),t.parentNode.appendChild(this._containerEl),this._fromEl=t;var o=this._containerEl.animate([{height:t.offsetHeight+"px",width:t.offsetWidth+"px",opacity:0},{height:this._containerEl.scrollHeight+"px",width:this._containerEl.scrollWidth+"px",opacity:1,easing:"ease-in-out"}],this.options.animationTime/2);L.DomEvent.on(o,"finish",function(){L.extend(this._containerEl.style,{height:this._containerEl.scrollHeight+"px",width:this._containerEl.scrollWidth+"px"})},this),o=this._canvasEl.animate([{opacity:0},{opacity:1}],this.options.animationTime),L.DomEvent.on(o,"finish",function(){L.extend(this._canvasEl.style,{opacity:1})},this),o=t.animate([{opacity:1},{opacity:0}],this.options.animationTime),L.DomEvent.on(o,"finish",function(){t.style.display="none"})}}),L.llc.view=function(t,i){return new L.llc.View(t,i)},L.llc.Control=L.Control.extend({includes:L.Mixin.Events,options:{position:"bottomright",layers:{animationTime:500,showAreas:!0,formatArea:function(t){return t>=1e3?L.Util.formatNum(t/1e4,4)+"ha":L.Util.formatNum(t,4)+"mÂ²"},groups:[],defaultGroup:null},parentElement:null},initialize:function(t){var i=L.extend({},this.options.layers,t&&t.layers);t=L.extend({},this.options,t||{},{layers:i}),L.Control.prototype.initialize.call(this,t)},addLayer:function(t){return this._toInvoke("addLayer",t),this},addLegend:function(t,i){return this._toInvoke("addLegend",t,i),this},hideLayer:function(t){return this._toInvoke("hideLayer",t),this},showLayer:function(t){return this._toInvoke("showLayer",t),this},onAdd:function(t){this._viewLayers=L.llc.view(t,this.options);var i=L.DomUtil.create("div","llc llc-button");return L.DomEvent.on(i,"click",this._onButtonClick,this).on(i,"click",L.DomEvent.stop).on(i,"dblclick",L.DomEvent.stop).on(i,"mousedown",L.DomEvent.stop),this._invokeInvokes(),this._map.eachLayer(function(t){this._viewLayers.addLayer(t,!0)},this),i},updateAreas:function(){return this._toInvoke("updateAreas"),this},_invokeInvoke:function(t){this._viewLayers&&this._viewLayers[t.method].apply(this._viewLayers,t.args)},_invokeInvokes:function(){if(this._invokes)for(var t=0;t<this._invokes.length;t++)this._invokeInvoke(this._invokes[t])},_onButtonClick:function(){this._viewLayers.show(this._container,this.getPosition())},_toInvoke:function(t){var i=Array.prototype.slice.call(arguments,1);this._invokes||(this._invokes=[]);var e={method:t,args:i};this._invokes.push(e),this._invokeInvoke(e)}}),L.Control.lc=function(t){return new L.llc.Control(t)},L.Path.prototype.setOpacity||!function(){L.Path.SVG||L.Path.VML?(L.Path.include({setOpacity:function(t){this._opacity=t,this._container&&(this._container.style.opacity=t)},_updateOpacity:function(){void 0!==this._opacity&&this.setOpacity(this._opacity)}}),L.Path.addInitHook(function(){this.on("add",this._updateOpacity)})):L.Path.CANVAS&&L.Path.include({setOpacity:function(t){this._opacity=t,this.redraw()},_updatePath:function(){if(!this._checkIfEmpty()){var t=this._ctx,i=this.options,e=void 0!==this._opacity?this._opacity:1;this._drawPath(),t.save(),this._updateStyle(),i.fill&&(t.globalAlpha=i.fillOpacity*e,t.fill(i.fillRule||"evenodd")),i.stroke&&(t.globalAlpha=i.opacity*e,t.stroke()),t.restore()}}})}(),L.FeatureGroup.prototype.setOpacity||L.FeatureGroup.include({setOpacity:function(t){this.eachLayer(function(i){i.setOpacity&&i.setOpacity(t)})}});